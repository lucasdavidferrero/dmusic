#!/bin/bash
# Simple bash program to download music from youtube.
DEST_PATH=""
if ! which youtube-dl >/dev/null;
then
    echo "You must install youtube-dl utility to run this script."
    echo "for more information visit: https://rg3.github.io/youtube-dl/download.html"
    exit 2
fi

if [ -z $2 ];
then
    DEST_PATH="./"
else if [ -d $2 ] && [ -w $2 ];
     then
	 DEST_PATH="$2"
     else
	 echo "The destination directory doesn't exist or you don't have permission in It."
	 exit 2
     fi
fi
echo "Destination: $DEST_PATH"
if [ -n $1 ];
then
    youtube-dl --ignore-errors --ignore-config --newline --output '%(title)s.%(ext)s' \
	       --extract-audio --audio-quality 0 \
	       --embed-thumbnail --add-metadata --audio-format mp3 --exec "cp {} $DEST_PATH >/dev/null" $1;
else
    echo "Use this script as follows: dmusic ( VIDEO_URL | PLAYLIST_URL ) [ DEST ]"
    exit 2
fi
exit 0
